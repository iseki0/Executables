package space.iseki.executables.pe

import kotlin.jvm.JvmInline

/**
 * Represents a code page in a PE file.
 *
 * @property value the raw value of the code page
 */
@JvmInline
value class CodePage(val value: UInt) : Comparable<CodePage> {
    override fun toString(): String {
        return codePageRef[value] ?: value.toString()
    }

    override fun compareTo(other: CodePage): Int = value.compareTo(other.value)

    /**
     * returns the .net name of the code page, such as "windows-1252" for code page 1252; returns null if there is no corresponding .net name.
     */
    val dotNetName: String?
        get() = codePageRef[value]
}

private val codePageRef = mapOf(
    37u to "IBM037",
    437u to "IBM437",
    500u to "IBM500",
    708u to "ASMO-708",
    720u to "DOS-720",
    737u to "ibm737",
    775u to "ibm775",
    850u to "ibm850",
    852u to "ibm852",
    855u to "IBM855",
    857u to "ibm857",
    858u to "IBM00858",
    860u to "IBM860",
    861u to "ibm861",
    862u to "DOS-862",
    863u to "IBM863",
    864u to "IBM864",
    865u to "IBM865",
    866u to "cp866",
    869u to "ibm869",
    870u to "IBM870",
    874u to "windows-874",
    875u to "cp875",
    932u to "shift_jis",
    936u to "gb2312",
    949u to "ks_c_5601-1987",
    950u to "big5",
    1026u to "IBM1026",
    1047u to "IBM01047",
    1140u to "IBM01140",
    1141u to "IBM01141",
    1142u to "IBM01142",
    1143u to "IBM01143",
    1144u to "IBM01144",
    1145u to "IBM01145",
    1146u to "IBM01146",
    1147u to "IBM01147",
    1148u to "IBM01148",
    1149u to "IBM01149",
    1200u to "utf-16",
    1201u to "unicodeFFFE",
    1250u to "windows-1250",
    1251u to "windows-1251",
    1252u to "windows-1252",
    1253u to "windows-1253",
    1254u to "windows-1254",
    1255u to "windows-1255",
    1256u to "windows-1256",
    1257u to "windows-1257",
    1258u to "windows-1258",
    1361u to "Johab",
    10000u to "macintosh",
    10001u to "x-mac-japanese",
    10002u to "x-mac-chinesetrad",
    10003u to "x-mac-korean",
    10004u to "x-mac-arabic",
    10005u to "x-mac-hebrew",
    10006u to "x-mac-greek",
    10007u to "x-mac-cyrillic",
    10008u to "x-mac-chinesesimp",
    10010u to "x-mac-romanian",
    10017u to "x-mac-ukrainian",
    10021u to "x-mac-thai",
    10029u to "x-mac-ce",
    10079u to "x-mac-icelandic",
    10081u to "x-mac-turkish",
    10082u to "x-mac-croatian",
    12000u to "utf-32",
    12001u to "utf-32BE",
    20000u to "x-Chinese_CNS",
    20001u to "x-cp20001",
    20002u to "x_Chinese-Eten",
    20003u to "x-cp20003",
    20004u to "x-cp20004",
    20005u to "x-cp20005",
    20105u to "x-IA5",
    20106u to "x-IA5-German",
    20107u to "x-IA5-Swedish",
    20108u to "x-IA5-Norwegian",
    20127u to "us-ascii",
    20261u to "x-cp20261",
    20269u to "x-cp20269",
    20273u to "IBM273",
    20277u to "IBM277",
    20278u to "IBM278",
    20280u to "IBM280",
    20284u to "IBM284",
    20285u to "IBM285",
    20290u to "IBM290",
    20297u to "IBM297",
    20420u to "IBM420",
    20423u to "IBM423",
    20424u to "IBM424",
    20833u to "x-EBCDIC-KoreanExtended",
    20838u to "IBM-Thai",
    20866u to "koi8-r",
    20871u to "IBM871",
    20880u to "IBM880",
    20905u to "IBM905",
    20924u to "IBM00924",
    20932u to "EUC-JP",
    20936u to "x-cp20936",
    20949u to "x-cp20949",
    21025u to "cp1025",
    21866u to "koi8-u",
    28591u to "iso-8859-1",
    28592u to "iso-8859-2",
    28593u to "iso-8859-3",
    28594u to "iso-8859-4",
    28595u to "iso-8859-5",
    28596u to "iso-8859-6",
    28597u to "iso-8859-7",
    28598u to "iso-8859-8",
    28599u to "iso-8859-9",
    28603u to "iso-8859-13",
    28605u to "iso-8859-15",
    29001u to "x-Europa",
    38598u to "iso-8859-8-i",
    50220u to "iso-2022-jp",
    50221u to "csISO2022JP",
    50222u to "iso-2022-jp",
    50225u to "iso-2022-kr",
    50227u to "x-cp50227",
    51932u to "euc-jp",
    51936u to "EUC-CN",
    51949u to "euc-kr",
    52936u to "hz-gb-2312",
    54936u to "GB18030",
    57002u to "x-iscii-de",
    57003u to "x-iscii-be",
    57004u to "x-iscii-ta",
    57005u to "x-iscii-te",
    57006u to "x-iscii-as",
    57007u to "x-iscii-or",
    57008u to "x-iscii-ka",
    57009u to "x-iscii-ma",
    57010u to "x-iscii-gu",
    57011u to "x-iscii-pa",
    65000u to "utf-7",
    65001u to "utf-8",
).toMap()

